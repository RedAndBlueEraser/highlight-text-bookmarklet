<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Highlight Text and Format Text Bookmarklets</title>
    <meta name="author" content="Harry Wong (RedAndBlueEraser)">
    <style>
      html { font-family: Arial, Helvetica, sans-serif; }
      body { margin: 10px auto; max-width: 1000px; width: 98%; }
      a { color: blue; }
    </style>
  </head>
  <body>
    <h1>Highlight Text and Format Text Bookmarklets</h1>
    <p>Drag the bookmarklets into your bookmarks toolbar.</p>
    <ul>
      <li><a href="javascript:(()=>{const DEFAULT_BACKGROUND_COLOR=&quot;&quot;;const e=t=>{switch(t.nodeType){case Node.TEXT_NODE:return[t];case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:return Array.prototype.map.call(t.childNodes,t=>e(t)).flat();default:return[]}},t=(e,n=0)=>{switch(e.nodeType){case Node.TEXT_NODE:{if(n<e.length)return e;let r=null;for(;!(r=e.nextSibling)&&(e=e.parentNode););return r?t(r):null}case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:{const r=e.childNodes,o=r.length;for(let e=n;e<o;e++){const n=t(r[e]);if(n)return n}let l=null;for(;!(l=e.nextSibling)&&(e=e.parentNode););return l?t(l):null}default:{let n=null;for(;!(n=e.nextSibling)&&(e=e.parentNode););return n?t(n):null}}},n=(e,t=e.length||e.childNodes.length)=>{switch(e.nodeType){case Node.TEXT_NODE:{if(t>0&&e.length>0)return e;let r=null;for(;!(r=e.previousSibling)&&(e=e.parentNode););return r?n(r):null}case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:{const r=e.childNodes;for(let e=t;e-- >0;){const t=n(r[e]);if(t)return t}let o=null;for(;!(o=e.previousSibling)&&(e=e.parentNode););return o?n(o):null}default:{let t=null;for(;!(t=e.previousSibling)&&(e=e.parentNode););return t?n(t):null}}},r=(e,t)=>{const n=document.createElement(&quot;mark&quot;);return n.style.backgroundColor=t,e.parentNode.replaceChild(n,e),n.appendChild(e),n},o=(o,l)=>{(e=>{const r=e.startContainer,o=e.startOffset;switch(r.nodeType){case Node.TEXT_NODE:o>0&&e.setStart(r.splitText(o),0);break;case Node.ELEMENT_NODE:e.setStart(t(r,o),0)}const l=e.endContainer,a=e.endOffset;switch(l.nodeType){case Node.TEXT_NODE:a<l.length&&l.splitText(a);break;case Node.ELEMENT_NODE:const t=n(l,a);e.setEnd(t,t.length)}})(o);const a=o.commonAncestorContainer;switch(a.nodeType){case Node.TEXT_NODE:r(a,l);break;case Node.ELEMENT_NODE:const t=e(a),n=t.lastIndexOf(o.endContainer);for(let e=t.indexOf(o.startContainer);e<=n;e++)r(t[e],l)}},l=(e=window)=>{try{const t=e.getSelection();return t&&t.rangeCount>0?[t,...Array.prototype.flatMap.call(e.frames,e=>l(e))]:Array.prototype.flatMap.call(e.frames,e=>l(e))}catch(e){return console.error(e),[]}};(e=>{for(const t of l()){const n=t.rangeCount;for(let r=0;r<n;r++)try{o(t.getRangeAt(r),e)}catch(e){console.error(e)}t.removeAllRanges()}})(DEFAULT_BACKGROUND_COLOR)})();">Highlight Text</a></li>
      <li><a href="#" data-href="javascript:(()=>{const t=e=>{switch(e.nodeType){case Node.TEXT_NODE:return[e];case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:return Array.prototype.map.call(e.childNodes,e=>t(e)).flat();default:return[]}},e=(t,r=0)=>{switch(t.nodeType){case Node.TEXT_NODE:{if(r<t.length)return t;let o=null;for(;!(o=t.nextSibling)&&(t=t.parentNode););return o?e(o):null}case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:{const o=t.childNodes,a=o.length;for(let t=r;t<a;t++){const r=e(o[t]);if(r)return r}let i=null;for(;!(i=t.nextSibling)&&(t=t.parentNode););return i?e(i):null}default:{let r=null;for(;!(r=t.nextSibling)&&(t=t.parentNode););return r?e(r):null}}},r=(t,e=t.length||t.childNodes.length)=>{switch(t.nodeType){case Node.TEXT_NODE:{if(e>0&&t.length>0)return t;let o=null;for(;!(o=t.previousSibling)&&(t=t.parentNode););return o?r(o):null}case Node.ELEMENT_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:{const o=t.childNodes;for(let t=e;t-- >0;){const e=r(o[t]);if(e)return e}let a=null;for(;!(a=t.previousSibling)&&(t=t.parentNode););return a?r(a):null}default:{let e=null;for(;!(e=t.previousSibling)&&(t=t.parentNode););return e?r(e):null}}},o=(t,e)=>{const r=document.createElement(&quot;formatted-text&quot;);return Object.assign(r.style,e),t.parentNode.replaceChild(r,t),r.appendChild(t),r},a=(a,i)=>{(t=>{const o=t.startContainer,a=t.startOffset;switch(o.nodeType){case Node.TEXT_NODE:a>0&&t.setStart(o.splitText(a),0);break;case Node.ELEMENT_NODE:t.setStart(e(o,a),0)}const i=t.endContainer,l=t.endOffset;switch(i.nodeType){case Node.TEXT_NODE:l<i.length&&i.splitText(l);break;case Node.ELEMENT_NODE:const e=r(i,l);t.setEnd(e,e.length)}})(a);const l=a.commonAncestorContainer;switch(l.nodeType){case Node.TEXT_NODE:o(l,i);break;case Node.ELEMENT_NODE:const e=t(l),r=e.lastIndexOf(a.endContainer);for(let t=e.indexOf(a.startContainer);t<=r;t++)o(e[t],i)}},i=(t=window)=>{try{const e=t.getSelection();return e&&e.rangeCount>0?[e,...Array.prototype.flatMap.call(t.frames,t=>i(t))]:Array.prototype.flatMap.call(t.frames,t=>i(t))}catch(t){return console.error(t),[]}},l=t=>{for(const e of i()){const r=e.rangeCount;for(let o=0;o<r;o++)try{a(e.getRangeAt(o),t)}catch(t){console.error(t)}e.removeAllRanges()}};(()=>{const t=document.createElement(&quot;iframe&quot;);document.body.appendChild(t);const e=t.contentDocument;e.open(),e.write('<!DOCTYPE html><html lang=en><meta charset=utf-8><meta content=&quot;width=device-width,initial-scale=1,shrink-to-fit=no&quot;name=viewport><main><button aria-label=Bold class=&quot;text-format-picker-item text-format-picker-item-bold&quot;title=Bold data-text-format-picker-value=&quot;font-weight=bold&quot;><span aria-hidden=true>B</span></button> <button aria-label=Italic class=&quot;text-format-picker-item text-format-picker-item-italic&quot;title=Italic data-text-format-picker-value=&quot;font-style=italic&quot;><span aria-hidden=true>I</span></button> <button aria-label=Underline class=&quot;text-format-picker-item text-format-picker-item-underline&quot;title=Underline data-text-format-picker-value=&quot;text-decoration=underline&quot;><span aria-hidden=true>U</span></button> <button aria-label=Strikethrough class=&quot;text-format-picker-item text-format-picker-item-strikethrough&quot;title=Strikethrough data-text-format-picker-value=&quot;text-decoration=line-through&quot;><span aria-hidden=true>ab</span></button> <button aria-label=Black class=&quot;text-format-picker-item text-format-picker-item-color text-format-picker-item-color-black&quot;title=Black data-text-format-picker-value=&quot;background-color=black&quot;></button> <button aria-label=Gray class=&quot;text-format-picker-item text-format-picker-item-color text-format-picker-item-color-gray&quot;title=Gray data-text-format-picker-value=&quot;background-color=gray&quot;></button> <button aria-label=Silver class=&quot;text-format-picker-item text-format-picker-item-color text-format-picker-item-color-silver&quot;title=Silver data-text-format-picker-value=&quot;background-color=silver&quot;></button> <button aria-label=White class=&quot;text-format-picker-item text-format-picker-item-color text-format-picker-item-color-white&quot;title=White data-text-format-picker-value=&quot;background-color=white&quot;></button> <button aria-label=Maroon class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Maroon data-text-format-picker-value=&quot;background-color=maroon&quot;></button> <button aria-label=Red class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Red data-text-format-picker-value=&quot;background-color=red&quot;></button> <button aria-label=Orange class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Orange data-text-format-picker-value=&quot;background-color=orange&quot;></button> <button aria-label=Yellow class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Yellow data-text-format-picker-value=&quot;background-color=yellow&quot;></button> <button aria-label=Lime class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Lime data-text-format-picker-value=&quot;background-color=lime&quot;></button> <button aria-label=Aqua class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Aqua data-text-format-picker-value=&quot;background-color=aqua&quot;></button> <button aria-label=Blue class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Blue data-text-format-picker-value=&quot;background-color=blue&quot;></button> <button aria-label=Navy class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Navy data-text-format-picker-value=&quot;background-color=navy&quot;></button> <button aria-label=Purple class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Purple data-text-format-picker-value=&quot;background-color=purple&quot;></button> <button aria-label=Fuchsia class=&quot;text-format-picker-item text-format-picker-item-color&quot;title=Fuchsia data-text-format-picker-value=&quot;background-color=fuchsia&quot;></button> <input aria-label=&quot;Color picker&quot;class=&quot;text-format-picker-item text-format-picker-item-color-picker&quot;title=&quot;Color picker&quot;type=color value=#ffff00> <button aria-label=Cancel class=&quot;text-format-picker-item text-format-picker-item-cancel&quot;title=Fuchsia>Cancel</button></main>'),e.close();let r=null;new Promise((e,r)=>{&quot;interactive&quot;===document.readyState||&quot;complete&quot;===document.readyState?e():(t.addEventListener(&quot;load&quot;,e,{once:!0}),t.addEventListener(&quot;error&quot;,r,{once:!0}))}).then(()=>new Promise((t,o)=>{const a=e.head.appendChild(e.createElement(&quot;style&quot;)),i=a.sheet;i&&i.cssRules?(r=i,t()):(a.remove(),o())}).catch(()=>new Promise((t,r)=>{let o=null;for(const t of document.styleSheets)try{if(t.cssRules){o=t.ownerNode;break}}catch(t){console.error(t)}o?((o=o.cloneNode(!0)).addEventListener(&quot;load&quot;,()=>{t(o)},{once:!0}),o.addEventListener(&quot;error&quot;,r,{once:!0}),e.head.appendChild(o)):r()}).then(t=>{r=t.sheet}))).then(()=>{for(let t=r.cssRules.length;t-- >0;)r.deleteRule(t);const o=[&quot;*{box-sizing:border-box}&quot;,&quot;html{font-size:12px}&quot;,'body{display:inline-block;font-family:system-ui,-apple-system,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,&quot;Liberation Sans&quot;,sans-serif;font-size:1rem;line-height:1.5;margin:0;-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:100%}',&quot;button,input{font-family:inherit;font-size:inherit;line-height:inherit;margin:0}&quot;,&quot;button{-webkit-appearance:button;border-radius:0;text-transform:none}&quot;,&quot;button:focus:not(:focus-visible){outline:0}&quot;,&quot;::-moz-focus-inner{border-style:none;padding:0}&quot;,&quot;main{background:padding-box #fff;border:1px solid rgba(0,0,0,.15);border-radius:.25rem;color:#212529;display:inline-grid;gap:.5rem 2px;grid:[font-style grayscale] 2rem [color] 2rem [cancel] 2rem/repeat(12,2rem);padding:.5rem}&quot;,&quot;@media (prefers-color-scheme:dark){main{background-color:#343a40;color:#dee2e6}}&quot;,&quot;.text-format-picker-item{background-color:#fff;border:1px solid #dee2e6;border-radius:1px;padding:0;position:relative;text-align:center;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;vertical-align:middle}&quot;,&quot;@media (prefers-reduced-motion:reduce){.text-format-picker-item{transition:none}}&quot;,&quot;.text-format-picker-item:focus{border-color:#ffc107;box-shadow:0 0 0 .25rem rgba(255,193,7,.5);outline:0;z-index:1}&quot;,&quot;.text-format-picker-item:hover{border-color:#ffc107}&quot;,'.text-format-picker-item-bold,.text-format-picker-item-italic,.text-format-picker-item-strikethrough,.text-format-picker-item-underline{font-family:Verdana,system-ui,-apple-system,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,&quot;Liberation Sans&quot;,sans-serif;grid-row-start:font-style}',&quot;.text-format-picker-item-bold,.text-format-picker-item-italic,.text-format-picker-item-underline{font-size:1.166667rem}&quot;,&quot;.text-format-picker-item-bold{font-weight:700}&quot;,&quot;.text-format-picker-item-italic{font-style:italic}&quot;,&quot;.text-format-picker-item-underline{text-decoration:underline}&quot;,&quot;.text-format-picker-item-strikethrough{text-decoration:line-through}&quot;,&quot;.text-format-picker-item-color{grid-row:color}&quot;,&quot;.text-format-picker-item-color-black,.text-format-picker-item-color-gray,.text-format-picker-item-color-silver,.text-format-picker-item-color-white{grid-row:grayscale}&quot;,&quot;.text-format-picker-item-color-black{grid-column:6}&quot;,&quot;.text-format-picker-item-color-gray{grid-column:7}&quot;,&quot;.text-format-picker-item-color-silver{grid-column:8}&quot;,&quot;.text-format-picker-item-color-white{grid-column:9}&quot;,&quot;.text-format-picker-item-color-picker{grid-area:color/auto/auto/span 2;height:100%;padding:.25rem .5rem;width:100%}&quot;,&quot;.text-format-picker-item-color-picker::-moz-color-swatch{border-radius:1px}&quot;,&quot;.text-format-picker-item-color-picker::-webkit-color-swatch{border-radius:1px}&quot;,&quot;.text-format-picker-item-color-picker::-webkit-color-swatch-wrapper{padding:0}&quot;,&quot;.text-format-picker-item-cancel{color:#212529;grid-area:cancel/auto/auto/span 12}&quot;];for(const t of o.reverse())try{r.insertRule(t)}catch(t){console.error(t)}const{offsetHeight:a,offsetWidth:i}=e.body,c=t.style;c.border=&quot;0&quot;,c.height=a+&quot;px&quot;,c.opacity=&quot;1&quot;,c.position=&quot;fixed&quot;;const n=matchMedia(&quot;(prefers-reduced-motion: reduce)&quot;).matches;let s;c.transition=n?&quot;none&quot;:&quot;opacity 500ms&quot;,c.width=i+&quot;px&quot;,c.zIndex=&quot;9999&quot;;try{s=getSelection().getRangeAt(0).getBoundingClientRect()}catch(t){console.error(t),s={bottom:0,left:0,right:0,top:0}}c.left=s.right+&quot;px&quot;,c.top=s.bottom+&quot;px&quot;;let m=t.getBoundingClientRect();m.bottom>window.innerHeight&&(c.top=s.top-a+&quot;px&quot;),m.right>window.innerWidth&&(c.left=s.left-i+&quot;px&quot;),((m=t.getBoundingClientRect()).left<0||m.top<0)&&(c.left=c.top=&quot;0px&quot;);let d=setTimeout(n?()=>{t.remove()}:()=>{c.opacity=&quot;0&quot;,setTimeout(()=>{t.remove()},500)},1e4);document.addEventListener(&quot;scroll&quot;,()=>{t.remove()},{once:!0}),document.addEventListener(&quot;selectionchange&quot;,()=>{t.remove()},{once:!0});for(const r of e.getElementsByClassName(&quot;text-format-picker-item-color&quot;)){const e={};for(const t of r.getAttribute(&quot;data-text-format-picker-value&quot;).trim().split(/\s*&\s*/g)){const{0:r,1:o}=t.split(/\s*=\s*/g);e[r]=o}r.style.backgroundColor=e[&quot;background-color&quot;],r.addEventListener(&quot;click&quot;,()=>{l(e),t.remove()},{once:!0})}for(const r of e.querySelectorAll(&quot;.text-format-picker-item-bold, .text-format-picker-item-italic, .text-format-picker-item-underline, .text-format-picker-item-strikethrough&quot;)){const e={};for(const t of r.getAttribute(&quot;data-text-format-picker-value&quot;).trim().split(/\s*&\s*/g)){const{0:r,1:o}=t.split(/\s*=\s*/g);e[r]=o}r.addEventListener(&quot;click&quot;,()=>{l(e),t.remove()},{once:!0})}const p=e.getElementsByClassName(&quot;text-format-picker-item-color-picker&quot;)[0];return p.addEventListener(&quot;click&quot;,()=>{clearTimeout(d)},{once:!0}),p.addEventListener(&quot;change&quot;,()=>{l({backgroundColor:p.value}),t.remove()},{once:!0}),e.getElementsByClassName(&quot;text-format-picker-item-cancel&quot;)[0].addEventListener(&quot;click&quot;,()=>{t.remove()},{once:!0}),t.focus(),t},()=>{t.remove(),l({backgroundColor:&quot;yellow&quot;})})})()})();">Format Text</a></li>
    </ul>
    <p>You can test out the bookmarklets/hyperlinks on the text below. First select some text, then press Highlight Text or Format Text.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <script>
    for (const element of document.querySelectorAll("[data-href]")) {
      element.href = element.getAttribute("data-href");
    }
    </script>
  </body>
</html>
